<script type="module" src="../../../../@polymer/polymer/polymer-legacy.js"></script>
<script type="module" src="../../../../@polymer/iron-validator-behavior/iron-validator-behavior.js"></script>
<script type="module">
import '../../../../@polymer/polymer/polymer-legacy.js';
import { IronValidatorBehavior } from '../../../../@polymer/iron-validator-behavior/iron-validator-behavior.js';
import { Polymer } from '../../../../@polymer/polymer/lib/legacy/polymer-fn.js';
Polymer({

    is: 'log-target-validator',

    behaviors: [
        IronValidatorBehavior
    ],

    validate: function (str) {
        if (!str) {
            return false;
        }
        var allKeysMissing;
        var index;
        var keys = ['user_id', 'owner_id', 'cloud_id', 'machine_id', 'rule_id', 'stack_id', 'template_id', 'schedule_id', 'script_id', 'volume_id', 'key_id', 'job_id', 'shell_id', 'session_id', 'incident_id', 'job', 'action', 'error', 'type'];
        var allKeysMissing = keys.every(function(key,ind){
            index = ind;
            return str.indexOf(key+":") == -1;
        })
        if (allKeysMissing) {
            return false;
        }
        // TODO: check whether keys have values
        return !allKeysMissing;
    }

});
</script>