<script type="module" src="../../../../@polymer/polymer/polymer-legacy.js"></script>
<script type="module" src="../../../../@polymer/paper-styles/typography.js"></script>
<dom-module id="member-item-element">
    <template>
        <style include="shared-styles">
        :host {
        }

        paper-item:hover {
            cursor: pointer;
        }

        .flex-horizontal-with-ratios {
            @apply --layout-horizontal;
        }

        .flexchild {
            @apply --layout-flex;
        }
        </style>
        <paper-item on-tap="_viewMember" class$="info-item flex-horizontal-with-ratios [[indexClass]]">
            <div class="flexchild">
                <paper-checkbox checked="{{selected}}" on-tap="_selectMember"></paper-checkbox> <span class="name">[[member.name]]</span>
            </div>
            <div class="flexchild">[[member.role]]</div>
            <slot></slot>
        </paper-item>
    </template>
    <script type="module">
import '../../../../@polymer/polymer/polymer-legacy.js';
import '../../../../@polymer/paper-styles/typography.js';
import { Polymer } from '../../../../@polymer/polymer/lib/legacy/polymer-fn.js';

Polymer({
    is: 'member-item-element',

    properties: {
        member: {
            type: Object
        },
        selected: {
            type: Boolean,
            value: false,
            notify: true
        },
        index: {
            type: Number
        },
        count: {
            type: Number
        },
        indexClass: {
            type: String,
            computed: '_computeIsIndexClass(index, count)'
        }
    },
    listeners: {
        'selected-changed': '_selectMemberChanged'
    },
    _computeIsIndexClass(index, count) {
        const classes = [];
        classes.push(
            (index + 1) % 2 == 0 ? 'even' : 'odd',
            index + 1 == count ? 'last' : null
        );
        return classes.join(' ');
    },
    _selectMemberChanged(e) {
        const selected = e.detail.value;
        this.dispatchEvent(new CustomEvent('toggleSelectedMember', { bubbles: true, composed: true, detail: {
            member: this.member,
            selected
        } }));

    },
    _viewMember(e) {
        this.dispatchEvent(new CustomEvent('go-to', { bubbles: true, composed: true, detail:  { url: `/members/${  this.member.id}` } }));
    },
    _selectMember(e) {
        // This is used to prevent event bubbling
        e.stopPropagation();
    }
});
</script>
</dom-module>