<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
<dom-module id="metric-menu">
    <template>
        <style include="shared-styles">
         :host {
            position: relative;
        }
        </style>

        <template is="dom-if" if="[[metric.options.length]]">
            <paper-item on-tap="toggle">[[metric.name]] <iron-icon icon="icons:expand-more"></iron-icon></paper-item>
            <iron-collapse id="collapse">
                <template is="dom-repeat" items="[[metric.options]]">
                    <metric-menu metric="[[item]]"></metric-menu>
                </template>
            </iron-collapse>
        </template>

        <template is="dom-if" if="[[!metric.options.length]]">
            <paper-item on-tap="addGraph">[[metric.name]] </paper-item>
        </template>

    </template>
    <script>
    Polymer({
        is: "metric-menu",
        properties: {            
            metric: {
                type: Object
            }
        },
        toggle: function(e) {
            this.shadowRoot.querySelector('iron-collapse').toggle();
        },
        addGraph: function(e){
            this.dispatchEvent(new CustomEvent('panel-added', { bubbles: true, composed: true, detail: { metric: this.metric.name } }));
        }

    });
    </script>
</dom-module>